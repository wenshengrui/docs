
			Linux 学习总结
=====================================================================================================================================================
													一、基础知识总结
=====================================================================================================================================================
1. shell识别三种命令：内建命令，shell函数以及外部命令
(1)内建命令：shell本身所执行的命令
(2)shell函数：用shell语言编写的一系列的功能健全的程序代码
(3)外部命令：shell执行的命令

2. shell变量
shell变量名称：以字母或下划线开头的一个字符串
shell变量赋值：先写变量名称，紧接着 = 字符，最后是新值.如 str='123456' 

单行可进行多次赋值
(1) first=isaac middle=basehevis last=singer 
(2) str="123 abc 456 efg"
(3) str1=$str
shell获取变量：$str $str1

3. shell 输出
echo 变量名称
echo 的转义序列

\a 警示字符
\b 退格
\c 换行
\f 清除屏幕
\n 换行
\r 回车

=====================================================================================================================================================
													二、基础命令总结
=====================================================================================================================================================
1:ls相关选项：  
	-a 这个选项可以显示以.开头的隐藏文件
	-i 显示每个文件的inode号，
	-R 同时列出所有子目录层
	-l 以长格式显示
	-F 显示后缀
#比如：
目录 test/
可执行文件 ls* 后面都会带有一个*号
文档 test 没什么特别的显示

2：清屏：
clear
快捷键ctrl+l

3:date
使用date命令显示和修改linux上的系统时间，
修改方法：date MMDDhhmmyy
MM月：0-12
DD日：1-31
hh时：00-23
mm钟：0-59
yy年：1970-2037
#修改时需要管理员权限
示例：把日期修改成2010八月29日17点30分
date 082917302010


4:mkdir 创建目录
-p建立多级目录
-m建立目录的时候给目录赋予权限值
示例：
mkdir -p /name/a/b/c/d
删除现有多级目录：
rmdir -p /name/a/b/

#如果此处不加-p的话，每次只可以删除最后一个目录
如果加-p的话可以一次删除。
删除目录的时候本身一定要是空的

5:删除命令：rm 
-i 删除文件之前需要手工确认
-v 删除文件的时候显示信息
-r 删除目录 -f 忽略提示

6：复制命令:cp
-a此参数的效果和同时指定"-dpR"参数相同。
-R递归处理，将指定目录下的所有文件与子目录一并处理。
-p复制完成后保持目录的权限
-v在复制文件的时候显示进度
-f在复制的时候如果碰到目的文件名有重复的就将原先的删除，
#cp -vRp /etc/home/usr /test

7:  mv 剪切文件

mv除了有移动文件的功能之外还可以用来修改文件名
语法格式：mv [源文件和目录]  [目的文件和目录]
-f 禁止交互操作,在mv操作要覆盖某已有的目标文件时不给任何指示，指定此选项后，i选项将不再起作用。
-i 覆盖前先行询问用户。
#mv aaa  /redhat  把aaa剪切到/redhat目录下
mv install.log install  把install.log 修改成install 

8:  pwd 显示当前所在位置
all user 都可以使用

9：cd 用来切换目录的命令
这个是shell的内部文件，不存在于任何目录下
直接cd 或是cd~都可以回到家目录
cd - 切换到前一个工作目录
cd .. 也是切换到上一级目录
cd !$返回到前一次涉及到的目录

10： touch 创建文本文件

示例：touch a.txt //可以一次创建多个文档
# touch /a/{a,b,c}
#touch a b c 
以上两种方法都可以使用
如果想往文档里输入内容除了vi之外也可以这样写：echo " 内容" > a.txt 


11:  查看文本文件命令
cat 查看短点的文件 //不论多少全部一次显示
-n  由 1 开始对所有输出的行数编号 
-b  和 -n 相似,只不过对于空白行不编号 
more
分页显示文件内容 
b往上翻页 空格向下 q 或Q退出
less 如果想一页一页的看的话可以使用less
如果只是想看前三行head -3 password 默认的情况下只可以看前十行，
tail -4 文件名  就看文件的后几行，
tail -f  文件名           实时的查看文件 动态文件，随时监控 木马攻击


12: mount

示例：mount -t ext3 /dev/cdrom /mnt/cdrom 如果不加-t的话就是不指定文件系统类型
umount -a 卸载所有已经挂载上的
-t 所支持的文件系统类型有FAT32 NTFS EXT2 EXT3 ISO9660
卸载示例：umount /mnt/usb

13:ifconfig 查看当前的网卡配置信息
-a 查看所有网卡配置信息

ifconfig eth0 192.168.0.106 netmask 255.255.255.0 up 
意思就是说将当前IP修改成这个 是临时的IP reboot后将会消失

14：ln 产生链接文件
ln -s [源文件] [目标文件]

注意:源文件和目标文件一定要使用绝对路径

硬链接意思是一个档案可以有多个别名
软连接是说产生一个特殊的档案，该档案的内容指向另一个位置。

ln file1 file2  文件1链接到文件2 这个属于 硬链接 不能跨分区链接
ln -s file1 file2   软链接  可以跨文件系统

示例：
这里说的文件是目录：

ln -s /root/passwd  /home/redhat #文件别名必须没有被创建
看到有 passwd -> /root/passwd 即为链接成功

硬链接：不可以连接目录
ln a.txt www 连接的时候必须是www这个文件没有创建
链接目的：改变源文件目标文件就会改变，改变目标文件源文件也会改变

15：
whereis 显示系统命令和帮助手册所在的目录
whatis 命令名
例如whatis ln 显示该命令是做什么的
 
16：查找命令
find [搜索路径] [搜索关键字]  [文件或目录]
[root@root ~]# find /etc -name f*

解释下这个命令查找/etc下边所有以f开头的文件

也是查找命令：比find方便
locate 需要经常使用这个：updatedb 需要经常更新
使用方法 locate a.txt

grep 内容 所在文件
grep -v # 即排除带有#号的文件

17：帮助命令：
manual
man ls 格式 按Q键退出帮助
命令 --help
info ls

18：文件压缩
gzip -1 file 压缩速度最快 
gzip -9 file 压缩效果最好
但是不可以压缩目录 

解压
gunzip file.gz
gzip -d file.gz

tar 打包命令 
-c 产生一个.tar文件
-v 观看压缩过程
-f 制定压缩后的文件名
此命令使用的时候不需要加-

格式：tar cvf jesse.tar a.txt 把a.txt压缩成jesse.tar文件
对于常用的压缩目录命令：
tar zcvf file.tar.gz dir 
解压命令：
tar zxvf file.tar.gz

19：服务器之间通信

同一台服务器用户之间建立通信
write 用户名
即可实现即时消息通信
ctrl+d 结束消息

root 用户向群体发消息
wall 消息 群发

普通用户也可以使用
wall happy new year!
mesg n 消息屏蔽
mesg y
可以屏蔽普通用户的命令
但是不可以屏蔽管理员的消息

发邮件：
1:首先开启mail service 

command:service sendmail start

2:mail 用户名
  写内容
ctrl + d结束内容

3：收信
mail 
回车
回信直接按r
不想回信q退出

20:开关机命令
shutdown -h now 立即关机
init 0 关机
poweroff
halt 

reboot重启
init 6重启
shutdown -r now 重启
shutdown -h 10 10分钟后关机

=====================================================================================================================================================
													三、权限命令总结
=====================================================================================================================================================
1.	变换用户身份：su 命令
	示例：su root

如果是管理员到普通用户不需要密码，但如果是普通用户向其它用户或管理员转换的时候需要密码。
这样只是登陆的身份转变为root 但诸如文件之类的环境变量仍然是原登陆用户。

su - 命令

这样的话就是完全的转换。  

权限管理：(注：使用权限 -- root用户)
chmod
a: 所有的权限 
u：用户权限
g：组权限
o：其它用户权限

+ - =
r w x
r=read
w=write
x=excute 执行
示例:
chmod u-x 文件名  给文件减执行的权限
chmod u+x 文件名  给文件加执行的权限
chmod o+r 文件名  给其它用户加读的权限
chmod a=r 文件名  加所有的权限

八进制的数字来制定：0 1 2 3 4 5 6 7 
0：什么权限也没有

1	=		x		执行
2	=		w		写
3	1+2		x+w		wx
4	=		r		读 
5	4+1		r+x		rx
6	4+2		r+w		rw
7	1+2+4	x+w+r	rwx

示例：chmod 755 a.txt 

用    户：读写执行 
组 成 员：读执行
其它成员：读执行
-------------------------------
chmod -R 权限 用户名 //改变目录及目录下的所有权限
-R或--recursive 　递归处理，将指定目录下的所有文件及子目录一并处理

chown 改变文件或目录的所有人
-------------------------------------------------------------------
chmown -R 用户 文件或目录 //包括子目录下的文件或目录
只改变用户

# chown [-R] [用户名称] [文件或目录]
# chown [-R] [用户名称:组名称] [文件或目录]

chown -R 用户.组名 文件或目录
chown -R james.james a //即改变用户，也改变组。
------------------------------------------------------
chgrp 改变文件或目录的所属组
示例：chgrp -R tian a.txt 将文件改成天这个组
----------------------------------------------------
umask 设置文件的默认生成掩码

示例：

目录 755 +022=777
文件 644 +022+111=777

umask 444 设置umask码

如果umask 码改变了
用户建文件的权限也就改变了

=====================================================================================================================================================
													四、计划任务
=====================================================================================================================================================
周期性安排计划任务是靠crond这个进程，所以应该首先开启这个进程。

1:开启命令：service crond start
工作原理：
crond 进程搜索crontab 文件并载入内存
crontab文件即/var/spool/cron/目录下以用户名命名的文件
crond 进程启动后，它将首先检查是否用户设置了crontab文件，如果没有转入休眠状态释放系统资源，
crond 进程每分钟醒来一次，查看crontab文件决定当前是否有需要执行的命令。

命令执行后，任何输出都将作为邮件发给crontab所有有者。

cd  /var/spool/cron/
crontab -e  //使用编辑器编辑当前的crontab文件，当结束时，这个文件会自动安装
crontab  -l 将使在标准输出显示当前的crontab
crontab  -r 删除当前的crontab 文件

六部分组成：

*/1 * * * * /bin/echo "s dssssssssss" >> /home/test/a.txt

minute ：一小时中的那一分钟[0--59]
hour :一天中的那几个小时[0--23]
day-of-month: 一个月中的那一天[1--31]
mouth -of-year :一年中的哪个月[1--12]
day-of week:一周中的那一天[0-6]
command:执行命令，也可以使用命令的全路径 /bin/cp 不能是cp

这些项都不可以为空，必须填入

如果用户不需要指定其中的几项，那么可以使用通配符号“*” 表示
任何时间 （（（（每个时间字段都可以指定多个值，他们可以用（逗号）间隔）））） 


比如
3，4  6  22  7 * /bin/echo " ##################"  >> /root/one.txt

命令应该给出绝对路径，

用户必须具有运行所对应命令或程序的权限
-------------------------------------------------
示例：

15 5* * 1-5 /bin/echo "s dssssssssss" >> /root/one.txt

每周一到周五的5：15分都执行这个命令,如果是周一和周五执行，1,5 这样写，注意：其他的也是这样写。

*/2 每隔两小时 

8-17点 


用来限制那些用户可以使用crontab命令

/etc/cron.allow
/etc/cron.deny
/etc/cron.allow
如果这个文件存在。那么只在列在此文件夹中的用户才可以使用crontab命令，如果这个文件不存在，则查/etc/cron.deny

/etc/cron.deny
如果这个文件夹存在，则此文件中列出的用户都不能使用crontab命令，

如果两个文件都不存在，则只有root用户可以使用crontab命令。

如果两个文件都存在而且都为空，则所有用户都可以使用crontab命令
==========================================================================================================================================
crontab  
//执行周期性计划任务 
yum -y install crontabs
#service crond start
#crontab -l/r/e                             //显示/删除/编辑当前的周期性任务

格式：minutes hour day week month commands  
所有用*表示
不同时间用 ,
时间段用 - 

例子： 
#vim bak.sh

#!bin/bash
/bin/cp /root/data/file1 /root/data/`/bin/date +%Y%d%m%H%M`.bak
chmod -R 755 bak.sh
#crontab -e
*/1 * * * * /root/bak.sh
保存退出                                      
//每隔一分钟以日期为文件名备份

例子: 
0 1 * * * /bin/cp /root/date/file1 /root/date/file1.bak  
//每天1点备份file1文件

0 1 * * * 1－5 /bin/cp /root/date/file1 /root/date/file1.bak  
//每天1点（周一到周五）备份file1文件

*/1 * * * * /bin/cp /root/date/file1 /root/date/file1.bak  
//每隔一分钟备份file1文件

0,30 18-23 * * * /usr/local/apache/bin/apachectl restart(*/30 18-23 * * *)
//每天18:00-23:00之间每隔30分钟重启apache

0 23 * * 6 /usr/local/apache/bin/apachectl restart
上面的例子表示每星期六的晚上11点重启 apache 。

#date                                         //显示系统当前时间
#/usr/date +%Y-%m-%d-%H-%M                    //按指定格式显示

#vim /etc/cron.deny                           //不允许使用此命令的清单（黑名单）
#vim /etc/cron.allow                          //允许使用此命令的清单（白名单）

额外扩充：
at                                         //执行一次性计划任务
#service atd start
#at now +1 minutes/hours/days                       
at>ll /  >/root/ll.txt                      //一分钟/小时/天后执行计划
Ctrl+D  完成
#at -l/atq                                  //查看计划任务
#at -d/atrm                                 //删除计划任务

#at 14:30 09/08/2010                        //通过具体时间来执行计划
#at 14.30                                   //当天
#at 14:30 tomorrow                          //明天

#vim /etc/at.deny                           //不允许使用at命令的清单（黑名单）
#vim /etc/at.allow                          //允许使用at命令的清单（白名单）

#batch                                      //在系统的平均负荷(0.8%)下使用，不限时间


金锤将薛葵(擂 鼓 瓮 金 锤)		银锤将白文豹(八棱梅花亮银锤) 
铜锤将秦文(八挂生铜链子锤)		铁锤将熊天庆(八 楞 镔 铁 锤) 